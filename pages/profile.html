<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Profile - StreamX</title>
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.1/css/all.min.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">

    <!-- Custom Styles -->
    <link rel="stylesheet" href="../css/core/variables.css">
    <link rel="stylesheet" href="../css/core/layout.css">
    <link rel="stylesheet" href="../css/pages/profile.css">
    <!-- Image Cropper -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.13/cropper.min.css" />
</head>

<body>

    <div class="app-container">
        
        <!-- Main Content Area -->
        <main class="main-content">
            <header>
                <!-- Header Navigation -->
                <div class="header-actions" style="margin-left: auto;">
                    <button class="btn-glass" onclick="window.location.href='../index.html'"><i class="bi bi-arrow-left"></i> Home</button>
                </div>
            </header>

            <div id="content_area" style="padding: 2rem;">

                <!-- Profile Header -->
                <div class="profile-header">
                    <div class="profile-img-container">
                        <img src="https://via.placeholder.com/150" alt="Profile" class="profile-img"
                            id="profile_img_large">
                        <div class="edit-badge" id="edit_photo_btn" title="Change Photo"><i class="bi bi-camera"></i>
                        </div>
                    </div>
                    <div class="profile-info">
                        <h2 id="profile_name">Loading...</h2>
                        <p id="profile_email">...</p>
                        <button class="btn-glass" id="edit_profile_btn" style="font-size: 0.9rem; padding: 5px 15px;"><i
                                class="bi bi-pencil"></i> Edit Profile</button>
                    </div>
                </div>

                <!-- Tabs -->
                <div class="profile-tabs">
                    <button class="tab-btn active" data-tab="activity">Activity</button>
                    <button class="tab-btn" data-tab="watchlist">My Watchlist</button>
                </div>

                <!-- Activity Tab -->
                <div id="tab_activity" class="profile-tab-content">
                    <h3 style="margin-bottom: 1rem;">Recent Activity</h3>
                    <div id="activity_list">
                        <!-- Injected JS -->
                        <p style="color: #666;">No recent activity tracked.</p>
                    </div>
                </div>

                <!-- Watchlist Tab -->
                <div id="tab_watchlist" class="profile-tab-content hidden">
                    <h3 style="margin-bottom: 1rem;">My Watchlist <small style="font-size:0.8rem; color:#aaa;">(Click X
                            to remove)</small></h3>
                    <div class="grid-container" id="profile_watchlist_grid">
                        <!-- Injected JS -->
                    </div>
                </div>

                <!-- Bottom Logout -->
                <div style="text-align: center; margin-top: 3rem;">
                    <button class="btn-delete" id="logout_btn_header" style="padding: 10px 25px;">
                        <i class="bi bi-box-arrow-right"></i> Logout
                    </button>
                </div>

            </div>
        </main>

    </div>

    <!-- Edit Profile Modal -->
    <div id="profile_modal" class="modal hidden">
        <div class="modal-content" style="max-width: 400px;">
            <div class="modal-header">
                <h3>Edit Profile</h3>
                <span class="close-modal" id="close_profile_modal">&times;</span>
            </div>
            <div class="modal-body">
                <form id="profile_form" class="profile-edit-form">
                    <div class="profile-input-group">
                        <label>Display Name</label>
                        <input type="text" id="input_name" class="profile-input" required>
                    </div>
                    
                    <div class="profile-input-group">
                        <label>Profile Image</label>
                        <input type="text" id="input_photo_url" class="profile-input" placeholder="Paste Image URL">
                        
                        <div class="divider-text">- OR -</div>
                        
                        <label for="file_photo" class="custom-file-upload">
                            <i class="bi bi-cloud-upload"></i> Choose File
                        </label>
                        <input type="file" id="file_photo" accept="image/*" class="hidden-file-input">
                        
                        <div id="file_name_display" style="font-size: 0.8rem; color: var(--primary); margin-top: 5px; text-align: center;"></div>
                    </div>

                    <button type="submit" class="btn-primary full-width">Save Changes</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Image Crop Modal -->
    <div id="crop_modal" class="modal hidden" style="z-index: 2000;">
        <div class="modal-content" style="max-width: 500px; width: 90%;">
            <div class="modal-header">
                <h3>Adjust Photo</h3>
                <span class="close-modal" id="close_crop_modal">&times;</span>
            </div>
            <div class="modal-body" style="padding: 0;">
                <div style="max-height: 400px; overflow: hidden; background: #000; display: flex; justify-content: center;">
                    <img id="crop_image" style="max-width: 100%; display: block;" src="">
                </div>
                <div style="padding: 1rem; display: flex; justify-content: flex-end; gap: 10px;">
                     <button type="button" class="btn-glass" id="cancel_crop_btn">Cancel</button>
                     <button type="button" class="btn-primary" id="crop_confirm_btn">Crop & Save</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.13/cropper.min.js"></script>
    <script type="module" src="../js/pages/profile.js"></script>
</body>

</html>